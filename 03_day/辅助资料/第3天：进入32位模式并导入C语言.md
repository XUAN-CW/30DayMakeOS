# 第3天：进入32位模式并导入C语言

双击 `./第3天：进入32位模式并导入C语言/data/make.bat` 可见如下结果：

![Video_2020-08-09_034544_1](第3天：进入32位模式并导入C语言/Video_2020-08-09_034544_1.gif)

## 做出的修改

### asmhead.nas

在 `画面モードを設定` 完毕之后，`通过BIOS获取指示灯状态` 之前添加下面的代码段，使屏幕一半变为白色。

```assembly
;DS = 0xa000, SI=0, DS : SI=0xa0000
MOV BX,DS
MOV AX,0xa000
MOV DS,AX
MOV SI,0
draw:
MOV [SI],BYTE 15;15 表示白色
ADD SI,1
CMP SI,320*100;屏幕是 320*200 这里取其一半
JBE draw
MOV DS,BX
```

修改后的部分代码如下：

```assembly
;... ...
; 画面モードを設定

		MOV		AL,0x13			; VGA显卡，320x200x8bit
		MOV		AH,0x00
		INT		0x10
		MOV		BYTE [VMODE],8	; 屏幕的模式（参考C语言的引用）
		MOV		WORD [SCRNX],320
		MOV		WORD [SCRNY],200
		MOV		DWORD [VRAM],0x000a0000
		
		;DS = 0xa000, SI=0, DS : SI=0xa0000
        MOV BX,DS
        MOV AX,0xa000
        MOV DS,AX
        MOV SI,0
        draw:
        MOV [SI],BYTE 15;15 表示白色
        ADD SI,1
        CMP SI,320*100;屏幕是 320*200 这里取其一半
        JBE draw
        MOV DS,BX

; 通过BIOS获取指示灯状态

;... ...
```

